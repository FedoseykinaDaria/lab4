# Сервис для сохранения медицинских записок

---

На этом сайте вы можете отслеживать своё здоровье и здоровье своих близких с помощью медицинских записей. Вы можете создавать их прямо на этом сайте или загружать из готовых файлов формата .json. Сохраняй свои записи в файл на сате или в готовую базу данных. 

## Установка проекта и зависимостей

Чтобы установить проект, склонируйте репозиторий проекта с платформы GitHub. Для этого выберите один из приведённых ниже способов:

1. Загрузите zip-файл, доступный из репозитория проекта (Code -> Local -> Download ZIP).

2. Воспользуйтесь возможностями системы контроля версий Git. Для этого используйте встроенную на вашем устройстве программу для работы с командной строкой или любую другую программу, поддерживающую работу с ситемой контроля версий Git. Введите в терминал одну из следующтх команд:

    git clone https://github.com/FedoseykinaDaria/lab4.git

    ИЛИ

    git clone git@github.com:FedoseykinaDaria/lab4.git

Как только проект будет клонирован локально, просмотрите файл 'requirements.txt', чтобы увидеть используемые в проекте зависимости. Проверьте, устанволены ли эти компоненты на вашем ПК, или установите необходимые зависимости с помощью команды:
    pip install -r requirements.txt

## Запуск проекта

1. Прежде чем запустить проект, настройте собственный файл окружения. Для этого откройте файл окружения (.env) в текстовом редакторе или редакторе кода для следующих параметров:

    DEBUG=True
    SECRET_KEY=<your-secret-key>
    ALLOWED_HOSTS=localhost 127.0.0.1 [::1]

2. Запустите контейнер, используя утилиту Docker Compose. Для этого в командной строке выполните следующую команду:

    docker-compose up -d --build
    
    Эта команда поможет не только запустить контейнер проекта, но и пересобрать его образ под ваши настройки. Учтите, что для того, чтобы сборка контейнера прошла успешно, необходимо запустить Docker Desktop.

3. Если вы хотите использовать проект не в режиме разработке, а в режиме продакшн, вам необходимо внести изменения в файл env:

    DEBUG=False
    SECRET_KEY=<production-secret-key>
    ALLOWED_HOSTS=localhost
    POSTGRES_USER=<your_username>
    POSTGRES_PASSWORD=<your_password>

    Запуск контейнера при этом будет реализован с помощью команды, описанной в пункте 2.

4. Для завершения работы контейнера введите следующую команду:

    docker-compose down 

## Миграция данных

1. Для того, чтобы изменить базу данных, используемую в проекте, сначала неоходимо сохранить уже имеющиеся в таблицах данные. Для этого проверьте существующие в проекте миграции следующей командой:

    python manage.py migrate (для проведения всех миграций)

    ИЛИ

    python manage.py showmigrations (для выода списка миграций)

Убедившись, что миграция с базой данных была проведена, введите следующую команду, которая создаст dump-файл в формате .json, в котором будут записаны все имеющиеся в вашей базе даные.

    py manage.py dumpdata --indent=2 > data.json

2. После получения информации из базы данных SQLite в файле settings.py проекта необходимо перенести все основные настройки, касающиеся используемой базы данных (PostgreSQL). К ним относятся следующие параметры раздела DATABASES: ENGINE, NAME, USER, PASSWORD, HOST, PORT.

3. Проверьте настройки вашей среды в файле .env, а также его подключение к основному файлу settings.py. Обратите внимание на значения параметров SECRET_KEY, DEBUG, ALLOWED_HOSTS, параметры раздела DATABASES. 

4. Запустите контейнер и примените миграции, которые находятся в вашем проекте, для новой базы данных, чтобы не лишиться целостности уже имеющейся у вас структуры. Для этого используйте команду:

    docker-compose exec web python manage.py migrate

5. Как только основная информация о настройке базы данных будет внесена и миграции будут проведены, можно перенести наши данные в новую базу данных. Для этого в cmd вносится следующая команда:

    docker-compose exec web python manage.py loaddata data.json

6. После этого миграцию данных можно считать завершённой. Останется лишь проверить сохранность функционала вашего проекта, а затем его можно смело развивать и использовать как на этапе разработки, так и в продакшне.